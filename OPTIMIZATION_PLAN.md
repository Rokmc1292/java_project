# í¬ë¡¤ë§ ë¹„ìš© ì ˆê° ìµœì í™” ê³„íš

## ğŸ“Š í˜„ì¬ ìƒí™© ë¶„ì„

### ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
- **ScheduleCrawler**: 365ì¼ Ã— 7ë¦¬ê·¸ = 2,555íšŒ/ë…„
- **LiveScoreUpdater**: 60,480íšŒ/ì¼ Ã— 7ë¦¬ê·¸ = 423,360íšŒ/ì¼
- **WebDriver ìƒì„±**: ë§¤ í¬ë¡¤ë§ë§ˆë‹¤ ìƒì„±/ì¢…ë£Œ (ë©”ëª¨ë¦¬/CPU ì˜¤ë²„í—¤ë“œ)

### ì£¼ìš” ë¹„ìš© ë°œìƒ ìš”ì¸
1. âŒ ì‹œì¦Œ ì˜¤í”„ ê¸°ê°„ì—ë„ ë§¤ì¼ í¬ë¡¤ë§
2. âŒ LIVE ê²½ê¸° ì—†ì–´ë„ 10ì´ˆë§ˆë‹¤ í¬ë¡¤ë§
3. âŒ WebDriver ë°˜ë³µ ìƒì„±/ì¢…ë£Œ (í‰ê·  2-3ì´ˆ ì†Œìš”)
4. âŒ ë¶ˆí•„ìš”í•œ Thread.sleep() ë‹¤ìˆ˜ ì‚¬ìš©

---

## ğŸ¯ ìµœì í™” ë°©ì•ˆ

### 1ï¸âƒ£ ScheduleCrawler ì‹œì¦Œ ê¸°ë°˜ í¬ë¡¤ë§

**í˜„ì¬:**
```java
@Scheduled(cron = "0 0 3 * * *")  // ë§¤ì¼ ìƒˆë²½ 3ì‹œ
```

**ìµœì í™”:**
```java
// EPL: 8ì›”~5ì›”ë§Œ í¬ë¡¤ë§
@Scheduled(cron = "0 0 3 * 8-12 *")  // 8-12ì›”
@Scheduled(cron = "0 0 3 * 1-5 *")   // 1-5ì›”

// KBL: 9ì›”~4ì›”ë§Œ í¬ë¡¤ë§
@Scheduled(cron = "0 0 3 * 9-12 *")  // 9-12ì›”
@Scheduled(cron = "0 0 3 * 1-4 *")   // 1-4ì›”
```

**ì ˆê° íš¨ê³¼:**
- EPL/ì¶•êµ¬ ë¦¬ê·¸: 365ì¼ â†’ 305ì¼ (16% ì ˆê°)
- KBL: 365ì¼ â†’ 243ì¼ (33% ì ˆê°)
- **ì´ ì—°ê°„ í¬ë¡¤ë§: 2,555íšŒ â†’ 2,074íšŒ (18% ì ˆê°)**

---

### 2ï¸âƒ£ LiveScoreUpdater ë™ì  ë¹ˆë„ ì¡°ì •

**í˜„ì¬:**
```java
@Scheduled(fixedDelay = 10000)  // í•­ìƒ 10ì´ˆ
```

**ìµœì í™” ì „ëµ:**
- **LIVE ê²½ê¸° ìˆìŒ**: 10ì´ˆ ê°„ê²© (í˜„ì¬ ìœ ì§€)
- **LIVE ê²½ê¸° ì—†ìŒ**: 5ë¶„ ê°„ê²©ìœ¼ë¡œ ê°ì†Œ
- **ì‹œì¦Œ ì˜¤í”„**: 1ì‹œê°„ ê°„ê²©ìœ¼ë¡œ ê°ì†Œ

**êµ¬í˜„ ë°©ë²•:**
```java
@Scheduled(fixedDelay = 10000)
public void updateLiveScores() {
    List<Match> liveMatches = matchRepository.findByStatus("LIVE");
    List<Match> leagueLiveMatches = liveMatches.stream()
        .filter(m -> m.getLeague().getLeagueId().equals(leagueId))
        .toList();

    if (leagueLiveMatches.isEmpty()) {
        // LIVE ê²½ê¸° ì—†ìœ¼ë©´ ë¹¨ë¦¬ ì¢…ë£Œ (WebDriver ìƒì„± ì•ˆ í•¨)
        return;
    }

    // LIVE ê²½ê¸°ê°€ ìˆì„ ë•Œë§Œ í¬ë¡¤ë§ ì§„í–‰
    WebDriver driver = crawlerService.setupDriver();
    // ...
}
```

**ì ˆê° íš¨ê³¼:**
- LIVE ê²½ê¸° ì—†ëŠ” ì‹œê°„: í¬ë¡¤ë§ ê±´ë„ˆë›°ê¸°
- WebDriver ìƒì„± íšŸìˆ˜: ì•½ 70% ì ˆê° (í‰ê·  ê²½ê¸° ì‹œê°„ ê¸°ì¤€)
- **ì¼ì¼ í¬ë¡¤ë§: 423,360íšŒ â†’ ì•½ 130,000íšŒ (70% ì ˆê°)**

---

### 3ï¸âƒ£ WebDriver íƒ€ì„ì•„ì›ƒ ìµœì í™”

**í˜„ì¬:**
```java
driver.manage().timeouts().pageLoadTimeout(Duration.ofSeconds(30));
driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(5));
wait = new WebDriverWait(driver, Duration.ofSeconds(10));
```

**ìµœì í™”:**
```java
driver.manage().timeouts().pageLoadTimeout(Duration.ofSeconds(15));  // 30 â†’ 15ì´ˆ
driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(3));    // 5 â†’ 3ì´ˆ
wait = new WebDriverWait(driver, Duration.ofSeconds(8));             // 10 â†’ 8ì´ˆ
```

**ì ˆê° íš¨ê³¼:**
- í˜ì´ì§€ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ëŒ€ê¸° ì‹œê°„: 30ì´ˆ â†’ 15ì´ˆ (50% ì ˆê°)
- í‰ê·  í¬ë¡¤ë§ ì‹œê°„: ì•½ 2-3ì´ˆ â†’ 1-2ì´ˆ (30% ì ˆê°)

---

### 4ï¸âƒ£ ë¶ˆí•„ìš”í•œ Thread.sleep() ì œê±°

**í˜„ì¬ ë¬¸ì œì :**
```java
Thread.sleep(2000);  // ë™ì  ì½˜í…ì¸  ë¡œë”© ëŒ€ê¸°
Thread.sleep(1500);  // ì›” ê°„ ì „í™˜ ëŒ€ê¸°
Thread.sleep(500);   // ì¶”ê°€ ì•ˆì •í™”
```

**ìµœì í™”:**
```java
// ëª…ì‹œì  ëŒ€ê¸°ë§Œ ì‚¬ìš©
wait.until(ExpectedConditions.presenceOfElementLocated(selector));
// Thread.sleep() ì œê±°
```

**ì ˆê° íš¨ê³¼:**
- ë¶ˆí•„ìš”í•œ ëŒ€ê¸° ì‹œê°„ ì œê±°
- í¬ë¡¤ë§ ì†ë„ 20-30% í–¥ìƒ

---

### 5ï¸âƒ£ ì¬ì‹œë„ ë¡œì§ ìµœì í™”

**í˜„ì¬:**
```java
for (int retry = 0; retry < 3; retry++) {
    try {
        // í¬ë¡¤ë§
        break;
    } catch (Exception e) {
        Thread.sleep(2000);  // ì¬ì‹œë„ ì „ ëŒ€ê¸°
    }
}
```

**ìµœì í™”:**
```java
for (int retry = 0; retry < 2; retry++) {  // 3íšŒ â†’ 2íšŒ
    try {
        // í¬ë¡¤ë§
        break;
    } catch (Exception e) {
        Thread.sleep(1000);  // 2ì´ˆ â†’ 1ì´ˆ
    }
}
```

**ì ˆê° íš¨ê³¼:**
- ì¬ì‹œë„ íšŸìˆ˜ ê°ì†Œ: ìµœëŒ€ ëŒ€ê¸° ì‹œê°„ 6ì´ˆ â†’ 2ì´ˆ (66% ì ˆê°)

---

## ğŸ“ˆ ì˜ˆìƒ ë¹„ìš© ì ˆê° íš¨ê³¼

### ì—°ê°„ í¬ë¡¤ë§ íšŸìˆ˜ ë¹„êµ

| êµ¬ë¶„ | í˜„ì¬ | ìµœì í™” í›„ | ì ˆê°ë¥  |
|------|------|-----------|--------|
| ScheduleCrawler | 2,555íšŒ/ë…„ | 2,074íšŒ/ë…„ | **18% â†“** |
| LiveScoreUpdater | 154MíšŒ/ë…„ | 47MíšŒ/ë…„ | **70% â†“** |
| WebDriver ìƒì„± | 154MíšŒ/ë…„ | 47MíšŒ/ë…„ | **70% â†“** |

### ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ë¹„êµ

| ë¦¬ì†ŒìŠ¤ | í˜„ì¬ | ìµœì í™” í›„ | ì ˆê°ë¥  |
|--------|------|-----------|--------|
| CPU ì‚¬ìš©ëŸ‰ | 100% | 40% | **60% â†“** |
| ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ | 100% | 45% | **55% â†“** |
| ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ | 100% | 35% | **65% â†“** |

### ì˜ˆìƒ ë¹„ìš© ì ˆê° (AWS EC2 t3.medium ê¸°ì¤€)

- **í˜„ì¬ ë¹„ìš©**: $50/ì›” (CPU + ë©”ëª¨ë¦¬ + ë„¤íŠ¸ì›Œí¬)
- **ìµœì í™” í›„ ë¹„ìš©**: $20/ì›”
- **ì›”ê°„ ì ˆê°**: **$30/ì›” (60% â†“)**
- **ì—°ê°„ ì ˆê°**: **$360/ë…„**

---

## ğŸš€ ì ìš© ìš°ì„ ìˆœìœ„

### Phase 1: ì¦‰ì‹œ ì ìš© (Low Risk, High Impact)
1. âœ… LIVE ê²½ê¸° ì—†ì„ ë•Œ í¬ë¡¤ë§ ê±´ë„ˆë›°ê¸°
2. âœ… WebDriver íƒ€ì„ì•„ì›ƒ ìµœì í™”
3. âœ… ì¬ì‹œë„ íšŸìˆ˜ ê°ì†Œ

### Phase 2: ë‹¨ê³„ì  ì ìš© (Medium Risk, High Impact)
4. â³ ScheduleCrawler ì‹œì¦Œ ê¸°ë°˜ í¬ë¡¤ë§
5. â³ ë¶ˆí•„ìš”í•œ Thread.sleep() ì œê±°

### Phase 3: ì¶”ê°€ ìµœì í™” (Low Priority)
6. â³ ë¡œê¹… ë ˆë²¨ ìµœì í™” (DEBUG â†’ INFO)
7. â³ í˜ì´ì§€ ë¡œë“œ ì „ëµ ìµœì í™”

---

## ğŸ“ êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] EplScheduleCrawler ì‹œì¦Œ cron ì„¤ì •
- [ ] NbaScheduleCrawler ì‹œì¦Œ cron ì„¤ì •
- [ ] BundesligaScheduleCrawler ì‹œì¦Œ cron ì„¤ì •
- [ ] LaLigaScheduleCrawler ì‹œì¦Œ cron ì„¤ì •
- [ ] SerieAScheduleCrawler ì‹œì¦Œ cron ì„¤ì •
- [ ] Ligue1ScheduleCrawler ì‹œì¦Œ cron ì„¤ì •
- [ ] KblScheduleCrawler ì‹œì¦Œ cron ì„¤ì •
- [ ] ëª¨ë“  CrawlerService WebDriver íƒ€ì„ì•„ì›ƒ ìµœì í™”
- [ ] ëª¨ë“  Crawler Thread.sleep() ìµœì†Œí™”
- [ ] ì¬ì‹œë„ ë¡œì§ ìµœì í™” (3íšŒ â†’ 2íšŒ)
- [ ] í…ŒìŠ¤íŠ¸ ë° ê²€ì¦

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ì•ˆì •ì„± ìš°ì„ **: ìµœì í™”ë¡œ ì¸í•´ í¬ë¡¤ë§ ì‹¤íŒ¨ìœ¨ì´ ì¦ê°€í•˜ì§€ ì•Šë„ë¡ ëª¨ë‹ˆí„°ë§
2. **ì ì§„ì  ì ìš©**: Phase 1ë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ ì ìš©í•˜ê³  ê²€ì¦
3. **ë°±ì—… ì „ëµ**: ê¸°ì¡´ ì½”ë“œ ë°±ì—… ë° ë¡¤ë°± ê³„íš ìˆ˜ë¦½
4. **ëª¨ë‹ˆí„°ë§**: ì ìš© í›„ 1ì£¼ì¼ê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ì§€í‘œ

ì ìš© í›„ ë‹¤ìŒ ì§€í‘œë¥¼ ëª¨ë‹ˆí„°ë§:
- í¬ë¡¤ë§ ì„±ê³µë¥  (í˜„ì¬: ~98% ìœ ì§€ ëª©í‘œ)
- í‰ê·  í¬ë¡¤ë§ ì‹œê°„
- WebDriver ìƒì„± íšŸìˆ˜
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
- CPU ì‚¬ìš©ë¥ 
- ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½

---

**ì‘ì„±ì¼**: 2025-11-11
**ì ìš© ì˜ˆì •**: Phase 1 - ì¦‰ì‹œ ì ìš© ê°€ëŠ¥
